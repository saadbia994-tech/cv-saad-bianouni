<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="market" />
    <meta name="keywords" content="sut" />
    <meta name="author" content="saad" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>متجر الكتروني</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body class="bg-info text-center mt-5">
    <div class="container">
      <div class="row w-100">
        <h1>سوبر ماركت شام</h1> 
         <button  style="font-size: 30px;"  onclick="window.location.href='index.html'">
                            
                                 العودة للصفحة الرئيسية
                            
                           </button>
      </div>

      <div class="row w-75 mx-auto mt-5">
        <h3>اضافة منتج</h3>

        <div class="col">
          <input
            id="input1"
            class="w-100 h-100 text-center"
            type="text"
            placeholder="الوصف"
          />
        </div>

        <div class="col">
          <input
            id="input2"
            class="w-100 h-100 text-center"
            type="number"
            placeholder="المبلغ"
          />
        </div>

        <div class="col">
          <button
            onclick="add();"
            id="buttonadd"
            type="button"
            class="btn btn-light h-100 w-100"
          >
            اضافة
          </button>
        </div>
      </div>

      <div id="tbody" class="row w-75 mx-auto mt-5"></div>

      <div class="row w-75 mx-auto mt-5">
        <h3>شراء منتج</h3>

        <div class="col">
          <input
            id="input3"
            class="w-100 h-100 text-center"
            type="text"
            placeholder="الوصف"
          />
        </div>

        <div class="col">
          <input
            id="input4"
            class="w-100 h-100 text-center"
            type="number"
            placeholder="العدد"
          />
        </div>

        <div class="col">
          <input
            id="input5"
            class="w-100 h-100 text-center"
            type="number"
            placeholder="المبلغ"
          />
        </div>

        <div class="col">
          <button
            onclick="add2(input3.value, Number(input4.value) , Number(input5.value) );"
            id="buttonadd2"
            class="btn btn-light h-100 w-100"
          >
            اضافة
          </button>
        </div>
      </div>

      <div class="row">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">الوصف</th>
              <th scope="col">العدد</th>
              <th scope="col">المبلغ</th>
              <th scope="col">''</th>
            </tr>
          </thead>
          <tbody id="tbody2" class="table-group-divider"></tbody>
        </table>
      </div>
      <br /><br /><br />
      <span id="total" class="mt-5"><h3></h3></span>
    </div>

    <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script>
      let input1 = document.getElementById("input1");
      let input2 = document.getElementById("input2");
      let input3 = document.getElementById("input3");
      let input4 = document.getElementById("input4");
      let input5 = document.getElementById("input5");
      let buttonadd = document.getElementById("buttonadd");
      let buttonadd2 = document.getElementById("buttonadd2");
      let arr;
      let arr2;
      let total=0;

      if (localStorage.s != null) {
        arr = JSON.parse(localStorage.s);
      } else {
        arr = [];
      }

      if (localStorage.m != null) {
        arr2 = JSON.parse(localStorage.m);
      } else {
        arr2 = [];
      }

      function add() {
        let objdata = {
          tex1: input1.value,
          tex2: input2.value,
        };

        arr.push(objdata);
        localStorage.setItem("s", JSON.stringify(arr));

        showdata();
        cleardata();
      }




function showdata2() {
  let table = "";
  total = 0;  // إعادة تعيين المجموع

  for (let i = 0; i < arr2.length; i++) {
    table += `
      <tr>
        <td>${arr2[i].in1}</td>
        <td>${arr2[i].in2}</td>
        <td>${arr2[i].in3}</td>
        <td><button onclick="deletdata(${i})" type="button" class="btn btn-light h-100 w-100">الحذف</button></td>
      </tr>
    `;
    total += arr2[i].in2 * arr2[i].in3;  // حساب المجموع بشكل صحيح
  }

  document.getElementById("tbody2").innerHTML = table;
  document.getElementById("total").innerHTML = `<h3>المجموع: ${total}</h3>`;
}


      function deletdata(i) {
        arr2.splice(i, 1);
        localStorage.m = JSON.stringify(arr2);
        showdata2();
        
        
      }




showdata2();




      function add2(input1, input2, input3) {
       
        let objdata = {
          in1: input1,
          in2: input2,
          in3: input3,
        };
        total = total+ (input2*input3);
        document.getElementById("total").innerText = "المجموع: " + total
         arr2.push(objdata);
          localStorage.setItem("m", JSON.stringify(arr2));
          showdata2();
          cleardata();
      }

      function showdata() {
        let sh = "";

        for (let i = 0; i < arr.length; i++) {
          sh += `
      <div onclick="add2('${arr[i].tex1}', 1, '${arr[i].tex2}');" class="card my-2 ms-2 p-3 col-2 m-4">
        <h5> ${arr[i].tex1}</h5>
        <h5> ${arr[i].tex2}</h5>
      </div>
    `;
        }

        document.getElementById("tbody").innerHTML = sh;
      }

      

      function cleardata() {
        input1.value = "";
        input2.value = "";
        input3.value = "";
        input4.value = "";
        input5.value = "";
      }

      showdata();
    </script>
  </body>
</html>
